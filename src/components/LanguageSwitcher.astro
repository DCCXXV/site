---
import { ArrowRightLeft } from "lucide-astro";
import { getLangFromUrl } from "../i18n/utils";

const currentPath = Astro.url.pathname;
const currentLang = getLangFromUrl(Astro.url);

let alternateUrl;
if (currentLang === "en") {
    if (currentPath.includes('/en/')) {
        alternateUrl = currentPath.replace(/\/en\//, '/es/');
    } else {
        alternateUrl = `/es${currentPath}`;
    }
} else {
    if (currentPath.includes('/es/')) {
        alternateUrl = currentPath.replace(/^\/es/, "").replace(/\/es\//, '/en/') || "/";
    } else {
        alternateUrl = currentPath.replace(/^\/es/, "") || "/";
    }
}

const langCode = currentLang === "en" ? "es" : "en";
---

<a href={alternateUrl} hreflang={langCode}>
    <ArrowRightLeft size={14} />
    <span lang={langCode} class="lang-text">
        {currentLang === "en" ? "Espa√±ol" : "English"}
    </span>
    <span class="lang-code">
        {langCode}
    </span>
</a>
<style>
    a {
        background-color: var(--sol-metal);
        color: var(--sol-black);
        text-decoration: none;
        padding: 0.25rem 0.5rem;
        border: 4px double var(--sol-black);
        white-space: nowrap;
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
    }

    a:hover {
        filter: brightness(0.9);
    }

    .lang-text {
        display: inline;
    }

    .lang-code {
        display: none;
    }

    @media (max-width: 768px) {
        .lang-text {
            display: none;
        }
        .lang-code {
            display: inline;
        }
    }
</style>
